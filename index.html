<html lang="fa" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù† | ChatGPT Version</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- PDF & Word Readers -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>

    <style>
        body {
            font-family: 'Vazirmatn', sans-serif;
            background: #10a37f;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }
        /* Ø±Ù†Ú¯ Ø³Ø¨Ø² ChatGPT */
        
        .main-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        
        .chat-header {
            background: #10a37f;
            color: white;
            padding: 15px;
        }
        
        .msg-container {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
            scroll-behavior: smooth;
            background: #ffffff;
        }
        
        .msg-bubble {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 15px;
            margin-bottom: 15px;
            line-height: 1.7;
            font-size: 0.95rem;
        }
        
        .msg-user {
            background: #f0f0f0;
            color: #333;
            margin-right: auto;
            border-bottom-left-radius: 2px;
        }
        
        .msg-bot {
            background: #e7fcf5;
            color: #0d5f49;
            margin-left: auto;
            border: 1px solid #cbf5e6;
            border-bottom-right-radius: 2px;
        }
        
        pre {
            direction: ltr;
            background: #2d2d2d;
            color: #e0e0e0;
            padding: 10px;
            border-radius: 6px;
            overflow-x: auto;
            margin-top: 5px;
        }
        
        code {
            font-family: monospace;
        }
        
        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
            height: 6px;
            width: 6px;
            background-color: #10a37f;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
        }
        
        .typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        @keyframes typing {
            0%,
            80%,
            100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }
    </style>
</head>

<body>
    <div id="root" style="height: 100%;"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React; // ============================================================ // ðŸ”´ Ú©Ù„ÛŒØ¯ API Ø´Ø±Ú©Øª OpenAI (ChatGPT) Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ // Ú©Ù„ÛŒØ¯ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ sk-proj ÛŒØ§ sk- Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯ // ============================================================
        const API_KEY = "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"; const SYSTEM_INSTRUCTION = `ØªÙˆ Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ "Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù†"
        Ù‡Ø³ØªÛŒ. ØªØ®ØµØµâ€ŒÙ‡Ø§: Ù…Ø´Ø§ÙˆØ± ØªØ­ØµÛŒÙ„ÛŒØŒ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ†ÙˆÛŒØ³ØŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù‡Ø± Ø³Ù„Ù…Ø§Ø³ Ùˆ ÙØ±Ù‡Ù†Ú¯ Ø§ÛŒØ±Ø§Ù†. ÙˆØ¸Ø§ÛŒÙ: 1. Ù¾Ø§Ø³Ø® Ø¨Ù‡ Ø³ÙˆØ§Ù„Ø§Øª Ø¯Ø±Ø³ÛŒ Ùˆ Ú©Ù†Ú©ÙˆØ±ÛŒ. 2. Ù†ÙˆØ´ØªÙ† Ú©Ø¯Ù‡Ø§ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ†ÙˆÛŒØ³ÛŒ. 3. ØªØ­Ù„ÛŒÙ„ Ù…ØªÙ† ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ÛŒ Ú©Ø§Ø±Ø¨Ø±. Ù„Ø­Ù†: Ù…ÙˆØ¯Ø¨Ø§Ù†Ù‡ Ùˆ ÙØ§Ø±Ø³ÛŒ.`; const App = () => { const [messages, setMessages]
        = useState([]); const [input, setInput] = useState(''); const [loading, setLoading] = useState(false); const [attachment, setAttachment] = useState(null); const messagesEndRef = useRef(null); const fileInputRef = useRef(null); const scrollToBottom
        = () => { messagesEndRef.current?.scrollIntoView({ behavior: "smooth" }); }; useEffect(() => { scrollToBottom(); }, [messages, loading]); useEffect(() => { setMessages([{ role: 'assistant', text: `Ø³Ù„Ø§Ù…! Ù…Ù† Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù† Ù‡Ø³ØªÙ… (Ù…Ø¨ØªÙ†ÛŒ
        Ø¨Ø± ChatGPT 4o).\nÙ‡Ø± Ø³ÙˆØ§Ù„ÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø¯Ø±Ø³ØŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù†ÙˆÛŒØ³ÛŒ ÛŒØ§ Ø´Ù‡Ø± Ø³Ù„Ù…Ø§Ø³ Ø¯Ø§Ø±ÛŒØ¯ Ø¨Ù¾Ø±Ø³ÛŒØ¯.` }]); }, []); // Ù‡Ù†Ø¯Ù„ Ú©Ø±Ø¯Ù† ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ const handleFileChange = async (e) => { const file = e.target.files[0]; if (!file) return; if (file.type.startsWith('image/')) { const
        reader = new FileReader(); reader.onload = (ev) => setAttachment({ type: 'image', content: ev.target.result, name: file.name }); reader.readAsDataURL(file); } else if (file.type === 'application/pdf') { setLoading(true); try { const buffer = await
        file.arrayBuffer(); const pdf = await pdfjsLib.getDocument({ data: buffer }).promise; let fullText = ""; for (let i = 1; i
        <=p df.numPages; i++) { const page=a wait pdf.getPage(i); const textContent=a wait page.getTextContent(); fullText +=t extContent.items.map(s=> s.str).join(' ') + "\n"; } setAttachment({ type: 'text', content: fullText, name: file.name }); setInput(`Ù…ØªÙ† ÙØ§ÛŒÙ„ PDF (${file.name}) Ø±Ø§ Ø®Ù„Ø§ØµÙ‡ Ú©Ù†.`); } catch (err) { alert("Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† PDF"); } finally { setLoading(false); } } else if (file.name.endsWith('.docx'))
            { setLoading(true); try { const buffer = await file.arrayBuffer(); const result = await mammoth.extractRawText({ arrayBuffer: buffer }); setAttachment({ type: 'text', content: result.value, name: file.name }); setInput(`Ù…ØªÙ† ÙØ§ÛŒÙ„ Word (${file.name})
            Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†.`); } catch (err) { alert("Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† Word"); } finally { setLoading(false); } } else { const reader = new FileReader(); reader.onload = (ev) => { setAttachment({ type: 'text', content: ev.target.result, name: file.name });
            setInput(`Ø§ÛŒÙ† Ù…ØªÙ† ÙØ§ÛŒÙ„ Ø§Ø³Øª. Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†.`); }; reader.readAsText(file); } }; const sendMessage = async () => { if ((!input.trim() && !attachment) || loading) return; const userMsgText = input; const currentAttachment = attachment; setMessages(prev
            => [...prev, { role: 'user', text: userMsgText, attachmentPreview: currentAttachment?.type === 'image' ? currentAttachment.content : null }]); setInput(''); setAttachment(null); setLoading(true); try { // Ø³Ø§Ø®Øª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ OpenAI const apiMessages
            = [ { role: "system", content: SYSTEM_INSTRUCTION }, ...messages.map(m => ({ role: m.role, content: m.text })), // ØªØ§Ø±ÛŒØ®Ú†Ù‡ ]; // Ù¾ÛŒØ§Ù… Ø¬Ø¯ÛŒØ¯ let newContent = userMsgText; // Ø§Ú¯Ø± ÙØ§ÛŒÙ„ Ù…ØªÙ†ÛŒ Ø¨ÙˆØ¯ØŒ Ù…ØªÙ† Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù† if (currentAttachment && currentAttachment.type
            === 'text') { newContent += `\n\n--- Ù…Ø­ØªÙˆØ§ÛŒ ÙØ§ÛŒÙ„ (${currentAttachment.name}) ---\n${currentAttachment.content}\n---`; } // Ø³Ø§Ø®ØªØ§Ø± Ù¾ÛŒØ§Ù… Ù†Ù‡Ø§ÛŒÛŒ (Ù…ØªÙ† + ØªØµÙˆÛŒØ± Ø§Ø­ØªÙ…Ø§Ù„ÛŒ) let userMessageContent; if (currentAttachment && currentAttachment.type ===
            'image') { userMessageContent = [ { type: "text", text: newContent }, { type: "image_url", image_url: { url: currentAttachment.content } } ]; } else { userMessageContent = newContent; } apiMessages.push({ role: "user", content: userMessageContent
            }); // Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ OpenAI const response = await fetch("https://api.openai.com/v1/chat/completions", { method: "POST", headers: { "Content-Type": "application/json", "Authorization": `Bearer ${API_KEY}` }, body: JSON.stringify({ model: "gpt-4o-mini",
            // Ù…Ø¯Ù„ Ø§Ø±Ø²Ø§Ù† Ùˆ Ø³Ø±ÛŒØ¹ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª Ø¯ÛŒØ¯Ù† Ø¹Ú©Ø³ messages: apiMessages, temperature: 0.7 }) }); const data = await response.json(); if (data.error) { throw new Error(data.error.message); } const aiReply = data.choices[0].message.content; setMessages(prev
            => [...prev, { role: 'assistant', text: aiReply }]); } catch (error) { console.error(error); let errMsg = `âŒ Ø®Ø·Ø§: ${error.message}`; if (error.message.includes("Failed to fetch")) { errMsg = "âŒ Ø®Ø·Ø§ÛŒ Ø§ØªØµØ§Ù„ (CORS). OpenAI Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ…
            Ø§Ø² Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ Ù†Ù…ÛŒâ€ŒØ¯Ù‡Ø¯. Ù„Ø·ÙØ§Ù‹ Ø§Ø² Ø³Ø±ÙˆØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø§Ø² Ø±ÙˆØ´ Gemini Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…Ø§ÛŒÛŒØ¯."; } setMessages(prev => [...prev, { role: 'assistant', text: errMsg }]); } finally { setLoading(false); } }; const formatText = (text) => { let formatted = text
            .replace(/\*\*(.*?)\*\*/g, '<b>$1</b>') .replace(/```([\s\S]*?)```/g, '<pre>$1</pre>') .replace(/`(.*?)`/g, '<code style="background:#eee;padding:2px 4px;border-radius:4px">$1</code>') .replace(/\n/g, '<br>'); return { __html: formatted };
            }; return (
            <div className="main-container">
                <div className="chat-header flex justify-between items-center">
                    <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-xl border border-white/40">ðŸ¤–</div>
                        <div>
                            <h1 className="font-bold text-lg">Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù† (ChatGPT)</h1>
                            <span className="text-xs opacity-90">Ø¢Ù†Ù„Ø§ÛŒÙ†</span>
                        </div>
                    </div>
                </div>

                <div className="msg-container">
                    {messages.map((msg, i) => (
                    <div key={i} className={`flex w-full ${msg.role==='user' ? 'justify-start' : 'justify-end'}`}>
                        <div className={`msg-bubble ${msg.role==='user' ? 'msg-user' : 'msg-bot'}`}>
                            {msg.attachmentPreview && (
                            <img src={msg.attachmentPreview} className="max-w-full rounded-lg mb-2 border" alt="Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡" /> )}
                            <div dangerouslySetInnerHTML={formatText(msg.text)}></div>
                        </div>
                    </div>
                    ))} {loading && (
                    <div className="flex justify-end w-full">
                        <div className="msg-bubble msg-bot flex items-center gap-1">
                            <span className="typing-dot"></span><span className="typing-dot"></span><span className="typing-dot"></span>
                        </div>
                    </div>
                    )}
                    <div ref={messagesEndRef} />
                </div>

                <div className="p-3 bg-white border-t border-gray-200">
                    {attachment && (
                    <div className="flex items-center gap-2 mb-2 bg-green-50 p-2 rounded-lg text-sm text-green-800 border border-green-100">
                        <i className="fas fa-paperclip"></i> {attachment.name}
                        <button onClick={()=> setAttachment(null)} className="mr-auto text-red-500"><i className="fas fa-times"></i></button>
                    </div>
                    )}

                    <div className="flex items-end gap-2">
                        <input type="file" ref={fileInputRef} onChange={handleFileChange} className="hidden" accept="image/*,.pdf,.docx,.txt" />
                        <button onClick={()=> fileInputRef.current.click()} className="w-12 h-12 flex items-center justify-center rounded-full bg-gray-100 hover:bg-green-100 text-gray-500 hover:text-green-600 transition">
                                <i className="fas fa-plus text-lg"></i>
                            </button>

                        <textarea value={input} onChange={(e)=> setInput(e.target.value)}
                                onKeyDown={(e) => e.key === 'Enter' && !e.shiftKey && (e.preventDefault(), sendMessage())}
                                placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..."
                                className="flex-1 bg-gray-50 border border-gray-200 rounded-2xl px-4 py-3 focus:outline-none focus:border-green-500 resize-none h-12 max-h-32"
                                style={{minHeight: '48px'}}
                            ></textarea>

                        <button onClick={sendMessage} disabled={loading || (!input && !attachment)} className={`w-12 h-12 flex items-center justify-center rounded-full text-white transition shadow-lg ${loading ? 'bg-gray-400' : 'bg-green-600 hover:bg-green-700'}`}>
                                <i className="fas fa-paper-plane rtl:rotate-180"></i>
                            </button>
                    </div>
                </div>
            </div>
            ); }; const root = ReactDOM.createRoot(document.getElementById('root')); root.render(
            <App />);
    </script>
</body>

</html>
