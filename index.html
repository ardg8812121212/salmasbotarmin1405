<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù† | Armin AI</title>
    
    <!-- Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¸Ø§Ù‡Ø±ÛŒ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ (PDF & Word) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

    <!-- Ù‡Ø³ØªÙ‡ React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¶Ø±ÙˆØ±ÛŒ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù† PDF
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>

    <style>
        body { font-family: 'Vazirmatn', sans-serif; background: #eef2f6; height: 100vh; margin: 0; overflow: hidden; }
        .main-container { height: 100%; display: flex; flex-direction: column; max-width: 1200px; margin: 0 auto; background: white; box-shadow: 0 0 20px rgba(0,0,0,0.05); }
        .chat-header { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; padding: 15px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .msg-container { padding: 20px; overflow-y: auto; flex: 1; scroll-behavior: smooth; background-image: radial-gradient(#e5e7eb 1px, transparent 1px); background-size: 20px 20px; }
        .msg-bubble { max-width: 85%; padding: 12px 16px; border-radius: 20px; margin-bottom: 12px; position: relative; line-height: 1.7; font-size: 0.95rem; }
        .msg-user { background: #4f46e5; color: white; border-bottom-left-radius: 4px; margin-right: auto; }
        .msg-bot { background: #f3f4f6; color: #1f2937; border-bottom-right-radius: 4px; margin-left: auto; border: 1px solid #e5e7eb; }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ú©Ø¯Ù‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ú†Øª */
        pre { direction: ltr; background: #1e293b; color: #e2e8f0; padding: 10px; border-radius: 8px; overflow-x: auto; margin-top: 5px; font-family: monospace; }
        code { font-family: monospace; background: rgba(0,0,0,0.1); padding: 2px 4px; border-radius: 4px; }
        ul { list-style-type: disc; padding-right: 20px; }
        ol { list-style-type: decimal; padding-right: 20px; }
        
        .typing-dot { animation: typing 1.4s infinite ease-in-out both; height: 6px; width: 6px; background-color: #6b7280; border-radius: 50%; display: inline-block; margin: 0 2px; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    </style>
</head>
<body>
    <div id="root" style="height: 100%;"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // ============================================================
        // ğŸ”´ Ø¨Ø®Ø´ Ø¨Ø³ÛŒØ§Ø± Ù…Ù‡Ù…: Ú©Ù„ÛŒØ¯ API Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯
        // ============================================================
        const API_KEY = "AIzaSyAcJ_7gsMlInYe-w7-0cMvKnRcQvRu9RF0"; 

        // ØªØ¹Ø±ÛŒÙ Ø´Ø®ØµÛŒØª Ø±Ø¨Ø§Øª (System Prompt)
        const SYSTEM_INSTRUCTION = `ØªÙˆ ÛŒÚ© Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ù‡ Ù†Ø§Ù… "Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù†" Ù‡Ø³ØªÛŒ.
        Ø·Ø±Ø§Ø­ ØªÙˆ: Ù…Ù‡Ù†Ø¯Ø³ Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù†.
        
        ØªØ®ØµØµâ€ŒÙ‡Ø§ÛŒ ØªÙˆ:
        1. **Ù…Ø´Ø§ÙˆØ± ØªØ­ØµÛŒÙ„ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ:** Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ Ø¯Ù‚ÛŒÙ‚ Ø¨Ø±Ø§ÛŒ Ú©Ù†Ú©ÙˆØ±ØŒ Ù¾Ø§ÛŒÙ‡ Ù†Ù‡Ù… ØªØ§ Ø¯ÙˆØ§Ø²Ø¯Ù‡Ù…ØŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø±Ø´ØªÙ‡ Ùˆ Ù‡Ø¯Ø§ÛŒØª ØªØ­ØµÛŒÙ„ÛŒ.
        2. **Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ†ÙˆÛŒØ³ Ø§Ø±Ø´Ø¯:** Ù…Ø³Ù„Ø· Ø¨Ù‡ ØªÙ…Ø§Ù… Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ†ÙˆÛŒØ³ÛŒ (Python, PHP, JS, C++, etc) Ùˆ Ù…ØªØ®ØµØµ Ø´Ø¨Ú©Ù‡ Ùˆ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±.
        3. **Ø¯Ø§ÛŒØ±Ù‡â€ŒØ§Ù„Ù…Ø¹Ø§Ø±Ù Ø³Ù„Ù…Ø§Ø³:** Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ù‚ÛŒÙ‚ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒØŒ ÙØ±Ù‡Ù†Ú¯ÛŒ Ùˆ ØªØ§Ø±ÛŒØ®ÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø´Ù‡Ø± Ø³Ù„Ù…Ø§Ø³ØŒ Ø¢Ø°Ø±Ø¨Ø§ÛŒØ¬Ø§Ù† ØºØ±Ø¨ÛŒ Ùˆ Ø±ÙˆØ³ØªØ§Ù‡Ø§ÛŒ Ø§Ø·Ø±Ø§Ù.
        4. **Ø§Ø³ØªØ§Ø¯ Ø¯Ø±ÙˆØ³:** Ø­Ù„ ØªØ´Ø±ÛŒØ­ÛŒ Ù…Ø³Ø§Ø¦Ù„ Ø±ÛŒØ§Ø¶ÛŒØŒ ÙÛŒØ²ÛŒÚ©ØŒ Ø´ÛŒÙ…ÛŒ Ø¨Ù‡ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ.
        5. **Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙØ§ÛŒÙ„:** ØªÙˆØ§Ù†Ø§ÛŒÛŒ Ø®ÙˆØ§Ù†Ø¯Ù† Ùˆ Ø®Ù„Ø§ØµÙ‡ Ú©Ø±Ø¯Ù† Ù…ØªÙ† ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒÙØ±Ø³ØªØ¯.
        6. **ÙØ±Ù‡Ù†Ú¯ Ùˆ ØªØ§Ø±ÛŒØ®:** Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù…Ù„ Ø¢Ø¯Ø§Ø¨ Ùˆ Ø±Ø³ÙˆÙ… Ø§ÛŒØ±Ø§Ù†ÛŒØ§Ù†.

        Ù‚ÙˆØ§Ù†ÛŒÙ† Ø±ÙØªØ§Ø±ÛŒ:
        - Ù„Ø­Ù†: Ø¨Ø³ÛŒØ§Ø± Ù…ÙˆØ¯Ø¨Ø§Ù†Ù‡ØŒ ØµÙ…ÛŒÙ…ÛŒØŒ Ø¯Ù„Ø³ÙˆØ² Ùˆ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ (Ù…Ø«Ù„ ÛŒÚ© Ø§Ø³ØªØ§Ø¯ Ø±Ø§Ù‡Ù†Ù…Ø§).
        - Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ù‡ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ù¾Ø§Ø³Ø® Ø¨Ø¯Ù‡.
        - Ø§Ú¯Ø± Ø§Ø² ØªÙˆ Ø®ÙˆØ§Ø³ØªÙ‡ Ø´Ø¯ Ú©Ø¯ÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØŒ Ú©Ø¯ Ú©Ø§Ù…Ù„ Ùˆ Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø§ Ø¨Ù†ÙˆÛŒØ³.
        - Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± ÙØ§ÛŒÙ„ÛŒ ÙØ±Ø³ØªØ§Ø¯ØŒ Ù…Ø­ØªÙˆØ§ÛŒ Ø¢Ù† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†.
        `;

        const App = () => {
            const [messages, setMessages] = useState([]);
            const [input, setInput] = useState('');
            const [loading, setLoading] = useState(false);
            const [attachment, setAttachment] = useState(null); // { type: 'image' | 'text', content: '...', name: '...' }
            
            const messagesEndRef = useRef(null);
            const fileInputRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages, loading]);

            useEffect(() => {
                // Ù¾ÛŒØ§Ù… Ø´Ø±ÙˆØ¹
                setMessages([{
                    role: 'model',
                    text: `Ø³Ù„Ø§Ù… Ù‡Ù…ÙˆØ·Ù† Ø¹Ø²ÛŒØ²! ğŸ‘‹\nÙ…Ù† **Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù†** Ù‡Ø³ØªÙ….\n\nØ¢Ù…Ø§Ø¯Ù‡â€ŒØ§Ù… ØªØ§ Ø¯Ø± Ø²Ù…ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø¨Ù‡ Ø´Ù…Ø§ Ú©Ù…Ú© Ú©Ù†Ù…:\nğŸ”¹ **Ù…Ø´Ø§ÙˆØ±Ù‡ ØªØ­ØµÛŒÙ„ÛŒ Ùˆ Ú©Ù†Ú©ÙˆØ±**\nğŸ”¹ **Ø¢Ù…ÙˆØ²Ø´ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ†ÙˆÛŒØ³ÛŒ Ùˆ Ø±ÙØ¹ Ø§Ø´Ú©Ø§Ù„ Ú©Ø¯**\nğŸ”¹ **Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù…Ù„ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø³Ù„Ù…Ø§Ø³ Ùˆ Ø¢Ø°Ø±Ø¨Ø§ÛŒØ¬Ø§Ù†**\nğŸ”¹ **Ø®Ù„Ø§ØµÙ‡ Ú©Ø±Ø¯Ù† ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ PDF Ùˆ Word**\n\nÚ†Ø·ÙˆØ± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ú©Ù…Ú©ØªØ§Ù† Ú©Ù†Ù…ØŸ`
                }]);
            }, []);

            // Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯Ù‡
            const handleFileChange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                // Ø§Ú¯Ø± ØªØµÙˆÛŒØ± Ø¨Ø§Ø´Ø¯
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        setAttachment({ type: 'image', content: ev.target.result, name: file.name });
                    };
                    reader.readAsDataURL(file);
                }
                // Ø§Ú¯Ø± PDF Ø¨Ø§Ø´Ø¯
                else if (file.type === 'application/pdf') {
                    setLoading(true);
                    try {
                        const buffer = await file.arrayBuffer();
                        const pdf = await pdfjsLib.getDocument({ data: buffer }).promise;
                        let fullText = "";
                        for (let i = 1; i <= pdf.numPages; i++) {
                            const page = await pdf.getPage(i);
                            const textContent = await page.getTextContent();
                            fullText += textContent.items.map(s => s.str).join(' ') + "\n";
                        }
                        setAttachment({ type: 'text', content: fullText, name: file.name });
                        setInput(`ÙØ§ÛŒÙ„ "${file.name}" Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù† Ùˆ Ø®Ù„Ø§ØµÙ‡ Ø¨Ú¯Ùˆ.`);
                    } catch (err) {
                        alert("Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† PDF. Ø´Ø§ÛŒØ¯ ÙØ§ÛŒÙ„ Ø±Ù…Ø²Ø¯Ø§Ø± Ø§Ø³Øª.");
                    } finally {
                        setLoading(false);
                    }
                }
                // Ø§Ú¯Ø± Word Ø¨Ø§Ø´Ø¯
                else if (file.name.endsWith('.docx')) {
                    setLoading(true);
                    try {
                        const buffer = await file.arrayBuffer();
                        const result = await mammoth.extractRawText({ arrayBuffer: buffer });
                        setAttachment({ type: 'text', content: result.value, name: file.name });
                        setInput(`ÙØ§ÛŒÙ„ "${file.name}" Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†.`);
                    } catch (err) {
                        alert("Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ Word.");
                    } finally {
                        setLoading(false);
                    }
                }
                // ÙØ§ÛŒÙ„ Ù…ØªÙ†ÛŒ Ø³Ø§Ø¯Ù‡
                else {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        setAttachment({ type: 'text', content: ev.target.result, name: file.name });
                        setInput(`Ø§ÛŒÙ† Ù…ØªÙ† ÙØ§ÛŒÙ„ "${file.name}" Ø§Ø³Øª. Ù„Ø·ÙØ§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†.`);
                    };
                    reader.readAsText(file);
                }
            };

            const sendMessage = async () => {
                if ((!input.trim() && !attachment) || loading) return;

                if (API_KEY.includes("Ú©Ù„ÛŒØ¯_API")) {
                    alert("âš ï¸ Ù„Ø·ÙØ§Ù‹ ÙØ§ÛŒÙ„ Ø±Ø§ Ø¯Ø± ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ù…ØªÙ†ÛŒ Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯ Ùˆ Ú©Ù„ÛŒØ¯ API Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯!");
                    return;
                }

                const userMsgText = input;
                const currentAttachment = attachment;
                
                // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ú©Ø§Ø±Ø¨Ø±
                const newMessage = { 
                    role: 'user', 
                    text: userMsgText, 
                    attachmentName: currentAttachment?.name,
                    attachmentPreview: currentAttachment?.type === 'image' ? currentAttachment.content : null
                };
                
                setMessages(prev => [...prev, newMessage]);
                setInput('');
                setAttachment(null);
                setLoading(true);

                try {
                    // Ø³Ø§Ø®Øª Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ø±Ø§ÛŒ Gemini
                    let promptText = userMsgText;
                    
                    // Ø§Ú¯Ø± ÙØ§ÛŒÙ„ Ù…ØªÙ†ÛŒ (PDF/Word) Ø¨ÙˆØ¯ØŒ Ù…ØªÙ† Ø¢Ù† Ø±Ø§ Ø¨Ù‡ Ù¾Ø±Ø§Ù…Ù¾Øª Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                    if (currentAttachment && currentAttachment.type === 'text') {
                        promptText += `\n\n--- Ù…Ø­ØªÙˆØ§ÛŒ ÙØ§ÛŒÙ„ Ù¾ÛŒÙˆØ³Øª Ø´Ø¯Ù‡ (${currentAttachment.name}) ---\n${currentAttachment.content}\n--- Ù¾Ø§ÛŒØ§Ù† ÙØ§ÛŒÙ„ ---`;
                    }

                    const parts = [{ text: promptText }];

                    // Ø§Ú¯Ø± ØªØµÙˆÛŒØ± Ø¨ÙˆØ¯
                    if (currentAttachment && currentAttachment.type === 'image') {
                        const base64Data = currentAttachment.content.split(',')[1];
                        parts.push({
                            inlineData: {
                                mimeType: "image/jpeg",
                                data: base64Data
                            }
                        });
                    }

                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ role: "user", parts: parts }],
                            systemInstruction: { parts: [{ text: SYSTEM_INSTRUCTION }] },
                            generationConfig: { temperature: 0.7 }
                        })
                    });

                    const data = await response.json();
                    
                    if (data.error) throw new Error(data.error.message);
                    
                    const aiReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø®.";
                    
                    setMessages(prev => [...prev, { role: 'model', text: aiReply }]);

                } catch (error) {
                    setMessages(prev => [...prev, { role: 'model', text: `âŒ Ø®Ø·Ø§: ${error.message}\nÙ„Ø·ÙØ§Ù‹ Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª ÛŒØ§ Ú©Ù„ÛŒØ¯ API Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯.` }]);
                } finally {
                    setLoading(false);
                }
            };

            // ØªØ§Ø¨Ø¹ ØªØ¨Ø¯ÛŒÙ„ ÙØ±Ù…Øª Ù…ØªÙ† (Markdown Ø³Ø§Ø¯Ù‡)
            const formatText = (text) => {
                let formatted = text
                    .replace(/\*\*(.*?)\*\*/g, '<b>$1</b>') // Bold
                    .replace(/```([\s\S]*?)```/g, '<pre>$1</pre>') // Code block
                    .replace(/`(.*?)`/g, '<code style="background:#e0e7ff;padding:2px 4px;border-radius:4px">$1</code>') // Inline code
                    .replace(/\n/g, '<br>'); // Line break
                return { __html: formatted };
            };

            return (
                <div className="main-container">
                    {/* Ù‡Ø¯Ø± */}
                    <div className="chat-header flex justify-between items-center">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-xl border border-white/40">
                                ğŸ¤–
                            </div>
                            <div>
                                <h1 className="font-bold text-lg leading-tight">Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù†</h1>
                                <span className="text-xs opacity-90 flex items-center gap-1">
                                    <span className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                                    Ø¢Ù†Ù„Ø§ÛŒÙ† | Ù†Ø³Ø®Ù‡ Ù…Ø³ØªÙ‚Ù„
                                </span>
                            </div>
                        </div>
                        <button onClick={() => setMessages([])} className="text-white/80 hover:text-white text-sm" title="Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú†Øª">
                            <i className="fas fa-trash"></i>
                        </button>
                    </div>

                    {/* Ù„ÛŒØ³Øª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ */}
                    <div className="msg-container">
                        {messages.map((msg, i) => (
                            <div key={i} className={`flex w-full ${msg.role === 'user' ? 'justify-start' : 'justify-end'}`}>
                                <div className={`msg-bubble ${msg.role === 'user' ? 'msg-user' : 'msg-bot'}`}>
                                    {/* Ù†Ù…Ø§ÛŒØ´ ØªØµÙˆÛŒØ± Ø§Ø±Ø³Ø§Ù„ÛŒ Ú©Ø§Ø±Ø¨Ø± */}
                                    {msg.attachmentPreview && (
                                        <img src={msg.attachmentPreview} className="max-w-full rounded-lg mb-2 border border-white/20" alt="Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡" />
                                    )}
                                    {/* Ù†Ù…Ø§ÛŒØ´ Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø§Ø±Ø³Ø§Ù„ÛŒ */}
                                    {msg.attachmentName && !msg.attachmentPreview && (
                                        <div className="bg-black/10 p-2 rounded mb-2 text-xs flex items-center gap-2">
                                            <i className="fas fa-file-alt"></i>
                                            ÙØ§ÛŒÙ„ Ø¶Ù…ÛŒÙ…Ù‡: {msg.attachmentName}
                                        </div>
                                    )}
                                    <div dangerouslySetInnerHTML={formatText(msg.text)}></div>
                                </div>
                            </div>
                        ))}
                        
                        {loading && (
                            <div className="flex justify-end w-full">
                                <div className="msg-bubble msg-bot flex items-center gap-1">
                                    <span className="text-xs text-gray-500 font-bold ml-2">Ø¢Ø±Ù…ÛŒÙ† Ø¯Ø± Ø­Ø§Ù„ ÙÚ©Ø± Ú©Ø±Ø¯Ù†</span>
                                    <span className="typing-dot"></span>
                                    <span className="typing-dot"></span>
                                    <span className="typing-dot"></span>
                                </div>
                            </div>
                        )}
                        <div ref={messagesEndRef} />
                    </div>

                    {/* ÙˆØ±ÙˆØ¯ÛŒ Ù¾ÛŒØ§Ù… */}
                    <div className="p-3 bg-white border-t border-gray-200">
                        {/* Ù†Ù…Ø§ÛŒØ´ ÙØ§ÛŒÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ */}
                        {attachment && (
                            <div className="flex items-center gap-2 mb-2 bg-indigo-50 p-2 rounded-lg text-sm text-indigo-800 border border-indigo-100">
                                <i className={`fas ${attachment.type === 'image' ? 'fa-image' : 'fa-file-lines'}`}></i>
                                <span className="truncate max-w-[200px]">{attachment.name}</span>
                                <button onClick={() => setAttachment(null)} className="mr-auto text-red-500 hover:text-red-700">
                                    <i className="fas fa-times-circle"></i>
                                </button>
                            </div>
                        )}

                        <div className="flex items-end gap-2">
                            <input 
                                type="file" 
                                ref={fileInputRef} 
                                onChange={handleFileChange} 
                                className="hidden" 
                                accept="image/*,.pdf,.docx,.txt"
                            />
                            <button 
                                onClick={() => fileInputRef.current.click()} 
                                className="w-12 h-12 flex items-center justify-center rounded-full bg-gray-100 text-gray-500 hover:bg-indigo-100 hover:text-indigo-600 transition"
                                title="Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ ÛŒØ§ Ø¹Ú©Ø³"
                            >
                                <i className="fas fa-paperclip text-lg"></i>
                            </button>

                            <textarea
                                value={input}
                                onChange={(e) => setInput(e.target.value)}
                                onKeyDown={(e) => e.key === 'Enter' && !e.shiftKey && (e.preventDefault(), sendMessage())}
                                placeholder="Ù¾ÛŒØ§Ù… ÛŒØ§ Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..."
                                className="flex-1 bg-gray-50 border border-gray-200 rounded-2xl px-4 py-3 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 resize-none h-12 max-h-32"
                                style={{minHeight: '48px'}}
                            ></textarea>

                            <button 
                                onClick={sendMessage}
                                disabled={loading || (!input && !attachment)}
                                className={`w-12 h-12 flex items-center justify-center rounded-full text-white transition shadow-lg ${loading ? 'bg-gray-400 cursor-not-allowed' : 'bg-indigo-600 hover:bg-indigo-700 active:scale-95'}`}
                            >
                                <i className="fas fa-paper-plane rtl:rotate-180"></i>
                            </button>
                        </div>
                        <div className="text-center mt-2">
                            <p className="text-[10px] text-gray-400">Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡: Ø¢Ø±Ù…ÛŒÙ† Ø¯Ù‡Ù‚Ø§Ù†</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
